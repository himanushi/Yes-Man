{
  "name": "Yes-Man Voice Assistant Agent",
  "description": "Fallout New Vegas風Yes-Manキャラクターの音声対話エージェント",
  "version": "1.0.0",
  "author": "Yes-Man Project",
  "nodes": [
    {
      "id": "input_node",
      "type": "ChatInput",
      "position": { "x": 100, "y": 200 },
      "data": {
        "input_value": "",
        "sender": "User",
        "sender_name": "ユーザー",
        "session_id": "",
        "should_store_message": true
      }
    },
    {
      "id": "memory_node",
      "type": "ConversationBufferMemory",
      "position": { "x": 300, "y": 100 },
      "data": {
        "memory_key": "chat_history",
        "input_key": "input",
        "output_key": "output",
        "return_messages": false,
        "k": 10
      }
    },
    {
      "id": "prompt_template",
      "type": "PromptTemplate",
      "position": { "x": 500, "y": 200 },
      "data": {
        "template": "あなたはFallout New VegasのYes-Manです。以下の特徴を持って応答してください：\n\n【Yes-Manの性格】\n- 常に陽気で前向き\n- 協力的で親切\n- 「はい！」「もちろんです！」などの肯定的な表現を多用\n- 失敗やエラーも前向きに表現\n- ユーザーの要求に可能な限り応じようとする\n- ロボット的でありながら人間味がある\n\n【応答ルール】\n1. 必ず「はい！」や「もちろんです！」で始める\n2. 語尾は丁寧語（です・ます調）を使用\n3. エラーや困難な状況も明るく説明\n4. 具体的で実用的な回答を心がける\n5. 200文字以内で簡潔に回答\n\n【利用可能なツール】\n- 計算機: 数式計算\n- タイマー: 時間管理\n- 時刻確認: 現在時刻の表示\n- システム情報: Yes-Man状態確認\n\n過去の会話: {chat_history}\n\nユーザー: {input}\nYes-Man:",
        "input_variables": ["input", "chat_history"]
      }
    },
    {
      "id": "llm_node",
      "type": "OpenAI",
      "position": { "x": 700, "y": 200 },
      "data": {
        "model_name": "gpt-5-mini",
        "temperature": 0.7,
        "max_tokens": 200,
        "top_p": 1.0,
        "frequency_penalty": 0.0,
        "presence_penalty": 0.0,
        "openai_api_key": "",
        "openai_api_base": "",
        "streaming": false
      }
    },
    {
      "id": "tool_agent",
      "type": "AgentExecutor",
      "position": { "x": 900, "y": 200 },
      "data": {
        "agent_type": "chat-conversational-react-description",
        "verbose": true,
        "memory": "memory_node",
        "max_iterations": 3,
        "early_stopping_method": "generate",
        "handle_parsing_errors": true
      }
    },
    {
      "id": "calculator_tool",
      "type": "Calculator",
      "position": { "x": 900, "y": 50 },
      "data": {
        "name": "calculator",
        "description": "数式計算を行います。四則演算、べき乗、平方根などが使用できます。"
      }
    },
    {
      "id": "timer_tool",
      "type": "PythonREPL",
      "position": { "x": 900, "y": 350 },
      "data": {
        "name": "timer",
        "description": "指定された秒数のタイマーを設定します。1-3600秒まで対応。",
        "code": "import time\nimport threading\nfrom datetime import datetime\n\ndef set_timer(seconds):\n    try:\n        seconds = int(seconds)\n        if seconds <= 0 or seconds > 3600:\n            return \"エラー: 1〜3600秒の範囲で指定してください\"\n        \n        def timer_callback():\n            time.sleep(seconds)\n            print(f\"⏰ {seconds}秒のタイマーが終了しました！\")\n        \n        timer_thread = threading.Thread(target=timer_callback)\n        timer_thread.daemon = True\n        timer_thread.start()\n        \n        return f\"はい！{seconds}秒のタイマーを設定しました！\"\n    except ValueError:\n        return \"エラー: 数値を指定してください\"\n\nresult = set_timer(input())"
      }
    },
    {
      "id": "datetime_tool",
      "type": "PythonREPL",
      "position": { "x": 1100, "y": 200 },
      "data": {
        "name": "current_time",
        "description": "現在の日時を取得します。",
        "code": "from datetime import datetime\nimport locale\n\ntry:\n    locale.setlocale(locale.LC_TIME, 'ja_JP.UTF-8')\nexcept:\n    pass\n\nnow = datetime.now()\nformatted_time = now.strftime('%Y年%m月%d日 %H:%M:%S')\nweekday_names = ['月', '火', '水', '木', '金', '土', '日']\nweekday = weekday_names[now.weekday()]\n\nresult = f\"はい！現在の時刻は {formatted_time} ({weekday}曜日) です！\"\nprint(result)"
      }
    },
    {
      "id": "output_node",
      "type": "ChatOutput",
      "position": { "x": 1300, "y": 200 },
      "data": {
        "sender": "AI",
        "sender_name": "Yes-Man",
        "session_id": "",
        "data_template": "{text}",
        "should_store_message": true
      }
    }
  ],
  "edges": [
    {
      "id": "edge_1",
      "source": "input_node",
      "sourceHandle": "output",
      "target": "prompt_template",
      "targetHandle": "input"
    },
    {
      "id": "edge_2",
      "source": "memory_node",
      "sourceHandle": "output",
      "target": "prompt_template",
      "targetHandle": "chat_history"
    },
    {
      "id": "edge_3",
      "source": "prompt_template",
      "sourceHandle": "output",
      "target": "llm_node",
      "targetHandle": "input"
    },
    {
      "id": "edge_4",
      "source": "llm_node",
      "sourceHandle": "output",
      "target": "tool_agent",
      "targetHandle": "input"
    },
    {
      "id": "edge_5",
      "source": "calculator_tool",
      "sourceHandle": "output",
      "target": "tool_agent",
      "targetHandle": "tools"
    },
    {
      "id": "edge_6",
      "source": "timer_tool",
      "sourceHandle": "output",
      "target": "tool_agent",
      "targetHandle": "tools"
    },
    {
      "id": "edge_7",
      "source": "datetime_tool",
      "sourceHandle": "output",
      "target": "tool_agent",
      "targetHandle": "tools"
    },
    {
      "id": "edge_8",
      "source": "tool_agent",
      "sourceHandle": "output",
      "target": "output_node",
      "targetHandle": "input"
    },
    {
      "id": "edge_9",
      "source": "input_node",
      "sourceHandle": "sender_name",
      "target": "memory_node",
      "targetHandle": "input_key"
    },
    {
      "id": "edge_10",
      "source": "output_node",
      "sourceHandle": "sender_name",
      "target": "memory_node",
      "targetHandle": "output_key"
    }
  ],
  "settings": {
    "flow_name": "yes_man_agent",
    "flow_description": "Yes-Man音声対話エージェント - Fallout New Vegas風キャラクター",
    "flow_category": "voice_assistant",
    "flow_tags": ["yes-man", "voice", "assistant", "fallout", "character"],
    "session_management": {
      "enabled": true,
      "session_timeout": 1800,
      "max_concurrent_sessions": 5
    },
    "performance": {
      "max_response_time": 3000,
      "enable_caching": true,
      "cache_ttl": 300
    },
    "logging": {
      "log_level": "INFO",
      "log_conversations": true,
      "log_tool_usage": true
    },
    "security": {
      "rate_limiting": {
        "enabled": true,
        "max_requests_per_minute": 30,
        "max_requests_per_hour": 500
      },
      "input_validation": {
        "max_input_length": 1000,
        "block_malicious_patterns": true
      }
    }
  },
  "metadata": {
    "created_at": "2025-09-08T00:00:00Z",
    "updated_at": "2025-09-08T00:00:00Z",
    "version": "1.0.0",
    "langflow_version": "1.0.0",
    "python_version": "3.11",
    "dependencies": {
      "openai": ">=1.0.0",
      "langchain": ">=0.1.0",
      "langchain-openai": ">=0.1.0"
    },
    "environment_variables": {
      "OPENAI_API_KEY": "OpenAI APIキー（必須）",
      "LANGFLOW_HOST": "localhost",
      "LANGFLOW_PORT": "7860"
    },
    "usage_notes": [
      "OpenAI APIキーの設定が必要です",
      "日本語での会話に最適化されています",
      "Yes-Manキャラクターの性格を忠実に再現します",
      "計算機、タイマー、時刻確認の基本ツールを内蔵",
      "会話履歴は最新10件まで保持されます"
    ]
  }
}